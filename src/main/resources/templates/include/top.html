<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div th:fragment="top">

<nav class="navbar navbar-default">
    <div class="container-fluid">

<!--
  <a th:if = "!${session.user}" th:href="@{/account/login}">登录</a>
    <a th:if = "!${session.user}" th:href="@{/account/register}">注册</a>
   <span th:if = "${session.user}">
       <a th:href="@{/my/{username}(username = ${session.user.username})}"
                                       th:text = "${session.user}">

       </a>
   </span>
    <a th:href="@{/logout}" th:if = "${session.user}">退出</a>
    <span th:if = "${session.user}">
    <a th:href="@{/email/send}">邮件管理</a>
    <a href="#" th:href="@{/email/post/{username}(username = ${session.user.username})}">邮件列表</a>
    </span>


-->
        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav">

                <li id="homePage"> <a th:href="@{/homePage}">首页</a> </li>

                <li class="dropdown" th:if = "!${session.user}" id="account">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                       aria-haspopup="true" aria-expanded="false">账户 <span class="caret"></span></a>
                <ul  class="dropdown-menu">
                <li id="login"><a th:if = "!${session.user}" th:href="@{/account/login}">登录</a></li>
                    <li role="separator" class="divider"></li>
                <li id="register"><a th:if = "!${session.user}" th:href="@{/account/register}">注册</a></li>
            </ul>
                </li>
                <li class="dropdown" th:if = "${session.user}" id="email">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                       aria-haspopup="true" aria-expanded="false">邮件管理 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a th:href="@{/email/send}">发送邮件</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="#" th:href="@{/email/post/{username}(username = ${session.user.username})}">已发邮件</a></li>


                    </ul>
                </li>
            </ul>

            <ul class="nav navbar-nav navbar-right">
                <li th:if = "${session.user}" id="my">
       <a th:href="@{/my/{username}(username = ${session.user.username})}"
          th:text = "${session.user.username}">

       </a>
        </li>
<li> <a th:href="@{/logout}" th:if = "${session.user}">退出</a></li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->

    <script>
        $(function () {


$.post(
    "/email/url",
    {"url":window.location.pathname},
    function (result) {
       if (result == "my"){
        $("#my").addClass("active");
       }
       if (result == "email"){
           $("#email").addClass("active");
       }
       if (result == "account"){
           $("#account").addClass("active");
       }
       if (result == "homePage"){
            $("#homePage").addClass("active");
        }

    }
);
        });
    </script>
</nav>
</div>
</body>
</html>